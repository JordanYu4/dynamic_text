<html>
  <head>
    <link rel="stylesheet" type="text/css" href="styles.css" >
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
  </head>

  <body>
    <div id="text-container">
      <!-- <span>You can use</span> -->
      <span>So Christ himself gave the</span>
      <section id="dynamic-word">
        <div id="word" class="animated fadeInDown">
          apostles
        </div>
      </section>
    </div>

  </body>

  <footer>
    <script>
      let words = ['apostles', 'prophets', 'evangelists', 'pastors', 'teachers'];
      // let words = ['postgres', 'mongoDB', 'mySQL'];
      const target = document.getElementById("dynamic-word");

      function wordFactory(arr) {
        let idx = 1;
        const arrLength = arr.length;

        return () => {
          const word = arr[idx % arrLength];
          idx++;
          return word; 
        }
      }

      const wordGenerator = wordFactory(words);


      // Handling with event listeners alone is too complex when 
      // multiple callbacks are required 
      // Try using async and promises instead 
      
      function addEntry(node, entryAnimation) {
        node.classList.add('animated', entryAnimation);
      }
      function removeEntry(node, entryAnimation) {
        node.removeEventListener('animationend', removeEntry(target, 'fadeInDown'));
        node.classList.remove('animated', entryAnimation);
      }
      function addExit(node, exitAnimation) {
        node.classList.add('animated', exitAnimation);
      }
      function removeExit(node, exitAnimation) {
        node.classList.remove('animated', exitAnimation);
      }
      function changeText(node) {
        node.innerHTML = wordGenerator();
      }
      
      while (true) {
        target.addEventListener('animationend', removeEntry(target, 'fadeInDown'));

      }

      
      // add entry animation 

      // on animation end: remove entry animation 

      // add exit animation 

      // on animation end: remove exit animation, switch text 




      // ================== //

      function cycleWord(node, entryAnimation, exitAnimation) {
        console.log('cycling word');
        node.classList.add('animated', entryAnimation);

        function handleEntryEnd() {
          node.classList.remove('animated', entryAnimation);
          node.removeEventListener('animationend', handleEntryEnd);

          node.classList.add('animated', exitAnimation);

          function handleTextChange() {
            node.classList.remove('animated', exitAnimation);
            node.removeEventListener('animationend', handleTextChange);

            node.innerHTML = wordGenerator();
          }
          
          node.addEventListener('animationend', handleTextChange);
        }
        
        node.addEventListener('animationend', handleEntryEnd); 
      }

      setInterval(() => { cycleWord(target, 'fadeInDown', 'fadeOutDown') }, 1000);
    </script>
  </footer>
</html>