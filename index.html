<html>
  <head>
    <link rel="stylesheet" type="text/css" href="styles.css" >
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
  </head>

  <body>
    <div id="text-container">
      <!-- <span>You can use</span> -->
      <span>So Christ himself gave the</span>
      <section id="dynamic-word-container">
        <div id="word" class="animated fadeInDown">
          apostles
        </div>
      </section>
    </div>

  </body>

  <footer>
    <script>
      const words = ['apostles', 'prophets', 'evangelists', 'pastors', 'teachers'];
      // let words = ['postgres', 'mongoDB', 'mySQL'];
      const wordContainer = document.getElementById("dynamic-word-container");

      function wordFactory(arr) {
        let idx = 1;

        return () => {
          const word = arr[idx % arr.length];
          idx++;
          return word; 
        }
      }

      const wordGenerator = wordFactory(words);


      // Handling with event listeners alone is too complex when 
      // multiple callbacks are required 
      // Try using async and promises instead 
      
      // function addEntry(node, entryAnimation) {
      //   node.classList.add('animated', entryAnimation);
      // }
      // function removeEntry(node, entryAnimation) {
      //   node.removeEventListener('animationend', removeEntry(wordContainer, 'fadeInDown'));
      //   node.classList.remove('animated', entryAnimation);
      // }
      // function addExit(node, exitAnimation) {
      //   node.classList.add('animated', exitAnimation);
      // }
      // function removeExit(node, exitAnimation) {
      //   node.classList.remove('animated', exitAnimation);
      // }
      function changeText(node) {
        node.innerHTML = wordGenerator();
      }
      
      // while (true) {
      //   wordContainer.addEventListener('animationend', removeEntry(wordContainer, 'fadeInDown'));

      // }

      
      // add entry animation 

      // on animation end: remove entry animation 

      // add exit animation 

      // on animation end: remove exit animation, switch text 


      // ================== //

      function cycleWordSimply(node) {
        node.innerHTML = wordGenerator();
      }

      function cycleWord(node, entryAnimation, exitAnimation) {
        console.log('cycling word');
        node.classList.add('animated', entryAnimation);

        function handleEntryEnd() {
          node.classList.remove('animated', entryAnimation);
          node.removeEventListener('animationend', handleEntryEnd);

          node.classList.add('animated', exitAnimation);

          function handleTextChange() {
            node.classList.remove('animated', exitAnimation);
            node.removeEventListener('animationend', handleTextChange);

            node.innerHTML = wordGenerator();
          }
          
          node.addEventListener('animationend', handleTextChange);
        }
        
        node.addEventListener('animationend', handleEntryEnd); 
      }

      // setInterval(() => { cycleWord(wordContainer, 'fadeInDown', 'fadeOutDown') }, 1000);
      setInterval(() => { cycleWordSimply(wordContainer) }, 1500);
    </script>
  </footer>
</html>